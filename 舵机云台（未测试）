#include <ESP32Servo.h>

Servo servoHorizontal;  // 水平方向舵机
Servo servoVertical;    // 垂直方向舵机

const int servoHorizontalPin = 13;  // 水平舵机连接的引脚
const int servoVerticalPin = 12;    // 垂直舵机连接的引脚

const int minAngle = 0;    // 最小角度
const int maxAngle = 180;  // 最大角度
const int delayTime = 15;  // 每次移动的延迟时间(毫秒)

void setup() {
  ESP32PWM::allocateTimer(0);
  ESP32PWM::allocateTimer(1);
  ESP32PWM::allocateTimer(2);
  ESP32PWM::allocateTimer(3);
  
  servoHorizontal.setPeriodHertz(50);    // 标准50hz伺服
  servoVertical.setPeriodHertz(50);      // 标准50hz伺服
  
  servoHorizontal.attach(servoHorizontalPin, 500, 2400);
  servoVertical.attach(servoVerticalPin, 500, 2400);
}

void loop() {
  // 水平方向从0°到180°
  for (int angle = minAngle; angle <= maxAngle; angle++) {
    servoHorizontal.write(angle);
    delay(delayTime);
  }
  
  // 垂直方向从0°到180°
  for (int angle = minAngle; angle <= maxAngle; angle++) {
    servoVertical.write(angle);
    delay(delayTime);
  }
  
  // 水平方向从180°到0°
  for (int angle = maxAngle; angle >= minAngle; angle--) {
    servoHorizontal.write(angle);
    delay(delayTime);
  }
  
  // 垂直方向从180°到0°
  for (int angle = maxAngle; angle >= minAngle; angle--) {
    servoVertical.write(angle);
    delay(delayTime);
  }
}
